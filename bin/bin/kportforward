#!/bin/bash

port=9281
if [ "$#" -ge 1 ]; then
    port=$1
    shift
fi

current_context=$(kubectl config current-context)
selection=$(kubectl get pods | grep -v ^NAME | fzf -1 --query="$@" --header="$current_context | $port" | awk '{print $1}')

if [ ! -z "$selection" ]; then
    echo "Context: $current_context"
    echo "Pod: $selection"
    echo
    kubectl port-forward "$selection" $port
fi
