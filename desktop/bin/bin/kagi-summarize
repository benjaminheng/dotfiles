#!/bin/bash

function show_help {
    echo "Usage:"
    echo "  kagi-summarize [help|<TARGET>]"
    echo ""
    echo "Supported TARGETs:"
    echo "  - events-this-weekend       Summarize events happening this weekend"
}

function events_this_weekend {
    # Get the next Saturday's date
    next_saturday=$(date -d "saturday" +"%d %b")
    # Get the next Sunday's date
    next_sunday=$(date -d "sunday" +"%d %b")

    prompt="Things to do in singapore this weekend, ${next_saturday}-${next_sunday}. One event per line; bold title and short description. Be specific. Return 20 results. Prioritize new events. Prioritize public events."

    base_url="https://kagi.com/fastgpt?query="
    url="${base_url}${prompt}"
    xdg-open "$url"
}

case "$1" in
    help)
        show_help
        ;;

    events-this-weekend)
        events_this_weekend
        ;;

    *)
        show_help
        ;;
esac
